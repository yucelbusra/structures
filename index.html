<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Structural Engineer Roleplay</title>
  <style>
    /* --- ORIGINAL CSS PRESERVED --- */
    .step{padding:8px 12px;border-radius:8px;background:#ccc;font-weight:bold;color:#fff}
    .step.active{background:#0077cc}
    .step.completed{background:#2ecc71}
    body{margin:0;font-family:sans-serif;background-color:#cce7f6}
    .screen{display:none;min-height:100vh;width:100vw;justify-content:center;align-items:center;flex-direction:column;text-align:center;padding:20px;box-sizing:border-box}
    .active{display:flex}
    canvas{border:1px solid #888;margin-top:20px}

    /* Badge bar */
    #badgeBar{min-height:48px;display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .badge-wrapper{position:relative;width:48px;height:48px}
    .badge{width:100%;height:100%;border-radius:8px;object-fit:contain;border:1px solid #e0e0e0;background:#fff;box-shadow:0 1px 2px rgba(0,0,0,.06)}
    .badge.locked{filter:grayscale(100%) opacity(.5)}
    .lock-icon{position:absolute;top:50%;left:50%;width:22px;height:22px;transform:translate(-50%,-50%);opacity:.7;pointer-events:none}

    button{margin-top:10px;padding:10px 20px;font-size:16px;border:none;border-radius:8px;background-color:#0077cc;color:#fff;cursor:pointer}
    button:hover{background-color:#005fa3}
    button:disabled{background-color:#999;cursor:not-allowed}
    .hint-button{margin-left:10px;padding:2px 8px;font-size:14px}
    input,select{padding:6px;margin-top:5px;margin-bottom:10px;width:180px}

    #feedback{margin-top:20px;padding:10px;background-color:#e0f7e9;border-left:4px solid #2ecc71;display:none; text-align:left;}
    .feedback-error{background-color:#fff3cd !important; border-left:4px solid #f39c12 !important;}
    
    #hintModal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.6);justify-content:center;align-items:center;z-index:1000}
    #hintModal img{max-width:90vw;max-height:80vh}
    
    /* Animation for Badge */
    @keyframes fadeInOut {
        0% { opacity: 0; }
        10% { opacity: 1; }
        90% { opacity: 1; }
        100% { opacity: 0; display: none; }
    }

    /* Container for sequential steps */
    .calc-block { margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.6); border-radius: 8px; display: none; width: 100%; max-width: 500px; }
  </style>
</head>
<body>
  
  <div id="progressBar" style="display:flex;gap:20px;margin:20px 0 40px 0;">
    <div class="step" id="step1">üîπ Intro</div>
    <div class="step" id="step2">üìè Slab</div>
    <div class="step" id="step3">üìä Loads</div>
    <div class="step" id="step4">‚öñÔ∏è Design</div>
    <div class="step" id="step5">üéì Summary</div>
  </div>

  <div id="badgeBar" aria-label="Badges" style="display:flex;align-items:center;gap:10px;flex-wrap:wrap;margin:-30px 20px 20px 20px;"></div>

  <div id="introScreen" class="screen active">
    <h1>üßë‚Äçüîß Welcome, Construction Managers!</h1>
    <img src="./img/welcome.gif" alt="Welcome">
    <p>
      Your task is to design timber beams for a sustainable building project.<br>
      Start by entering your slab design parameters.
    </p>

    <p style="font-size: 0.85em; opacity: 0.85; margin-top: 12px;">
      <strong>Disclaimer:</strong> This tool is an educational research prototype under development. 
      Outputs are for learning purposes only and not for professional use.
    </p>

    <p style="font-size: 0.85em; opacity: 0.85;">
      <strong>Credits:</strong> Concept & Development ‚Äì Busra Yucel, Auburn University; 
      Conceptual & Technical Support ‚Äì Alper Turgut & Jose Henriques, Hasselt University
    </p>

    <button id="continueBtn">I'm Ready! ‚Üí</button>
  </div>

  <div id="canvasScreen" class="screen">
    <div style="display:flex;gap:40px;align-items:flex-start;">
      <div>
        <h2>Slab Design Parameters</h2>
        <label for="inputWidth">Width of Slab (W) (ft):</label><br>
        <input type="number" id="inputWidth" step="0.1"><br>
        <label for="inputLength">Length of Slab (L) (ft):</label><br>
        <input type="number" id="inputLength" step="0.1"><br>
        <label for="inputBeamCount">Number of Beams:</label><br>
        <input type="number" id="inputBeamCount" step="1" min="2"><br>
        <p id="spacingInfo" style="margin-top:10px;font-weight:bold;"></p>
        <button id="drawCanvasBtn">Visualize Design</button>
        <button id="backBtn">‚Üê Back</button>
      </div>
      <img src="./img/SlabDimensions.png" alt="Slab illustration" style="max-width:300px;">
    </div>

    <div style="display:flex;align-items:flex-start;gap:10px;margin-top:1px;">
      <canvas id="slabCanvas" width="400" height="400" style="border:1px solid #888;"></canvas>
    </div>

    <button id="continueToLoadBtn" style="margin-top:20px;">Continue ‚Üí</button>
  </div>

  <div id="loadScreen" class="screen">
    <div style="display:flex;gap:20px;align-items:flex-start;">
      <div>
        <h2>Load Parameters (psi)</h2>

        <label>Permanent (Dead) Load:</label><br>
        <input type="number" id="permanentLoad" step="0.1"><br>
        <img id="imgPermanent" src="./img/load-permanent.png" style="height:30px;display:none;"><br>

        <label>Snow Load:</label><br>
        <input type="number" id="snowLoad" step="0.1"><br>
        <img id="imgSnow" src="./img/load-snow.png" style="height:30px;display:none;"><br>

        <label>Wind Load:</label><br>
        <input type="number" id="windLoad" step="0.1"><br>
        <img id="imgWindPositive" src="./img/load-wind.png" style="height:30px;display:none;">
        <img id="imgWindNegative" src="./img/load-wind-negative.png" style="height:30px;display:none;"><br>

        <label>Mobile (Live) Load:</label><br>
        <input type="number" id="mobileLoad" step="0.1"><br>
        <img id="imgMobile" src="./img/load-mobile.png" style="height:30px;display:none;"><br>

        <div style="display:flex;flex-direction:column;align-items:center;">
            <canvas id="loadCanvas" width="400" height="400" style="border:1px solid #888;"></canvas>
            <div id="combinedLoadImage" style="display:none;text-align:center;margin:10px 0;"></div>
            <button id="toggleCombinedBtn" style="display:none;margin:10px;font-size:14px;">Show Combined Loads</button>
        </div>

        <div style="margin-top:20px; padding:15px; border:2px dashed #0077cc; border-radius:10px; background:white;">
            <h3>Calculate Total Design Load</h3>
            <p style="font-size:0.9em; margin-bottom:10px;">Sum all entered loads (Dead + Snow + |Wind| + Live)</p>
            <label>Total Load (psi):</label><br>
            <input type="number" id="inputTotalLoad" step="0.1"><br>
            <button id="checkTotalLoadBtn">Check Total</button>
            <div id="loadFeedback" style="display:none; margin-top:10px; padding:8px; border-radius:5px;"></div>
        </div>

        <button id="backToSlabBtn">‚Üê Back</button>
        <button type="button" id="continueToTributaryBtn" style="display:none; background-color:#2ecc71;">Continue ‚Üí</button>
      </div>
    </div>
  </div>

  <div id="tributaryScreen" class="screen">
    <h2>Design Calculation Phase</h2>

    <div style="display:flex;gap:40px;align-items:flex-start;">
      <div>
        <canvas id="loadCanvasPreview" width="300" height="300" style="border:1px solid #888;"></canvas>
        <div id="combinedImagePreview" style="text-align:center;margin-top:10px;"></div>
      </div>

      <div style="text-align:left; min-width:300px;">
        
        <div id="step1_trib">
            <label for="beamSelect">Choose Beam:</label><br>
            <select id="beamSelect"></select><br><br>

            <label for="tributaryWidth">Enter Tributary Width (ft):</label><br>
            <input type="number" id="tributaryWidth" step="0.1"><br>

            <button id="submitTribBtn">Check Tributary Width</button>
            <div id="tribFeedback" style="display:none; margin-top:10px; padding:10px; border-radius:5px;"></div>
            <img id="feedbackGif" style="display:none;max-width:200px;margin-top:10px;">
        </div>

        <div id="step2_lineLoad" class="calc-block">
            <h3>Calculate Line Load ($w$)</h3>
            <p>Formula: Total Load (psi) √ó Tributary Width (ft)</p>
            <label>Line Load ($w$) (lbs/ft):</label><br>
            <input type="number" id="inputLineLoad" step="0.1"><br>
            <button id="checkLineLoadBtn">Check Line Load</button>
            <div id="lineLoadFeedback" style="display:none; margin-top:10px; padding:10px; border-radius:5px;"></div>
        </div>

        <div id="step3_forces" class="calc-block">
            <h3>Calculate Forces</h3>
            <p>Use your verified $w$ and span $L$.</p>

            <label>Max Shear ($V_{max}$) (lbs):</label><br>
            <input type="number" id="inputVmax" step="0.1"><br>

            <label>Max Moment ($M_{max}$) (lbs-ft):</label><br>
            <input type="number" id="inputMmax" step="0.1"><br>
            
            <label>Max Deflection ($\delta_{max}$):</label><br>
            <input type="number" id="inputDelta" step="0.001"><br>

            <button id="checkForcesBtn">Check Forces</button>
            <div id="forcesFeedback" style="display:none; margin-top:10px; padding:10px; border-radius:5px;"></div>
        </div>

        <button id="continueToSummaryBtn" style="margin-top:20px; display:none;">Finish ‚Üí Summary</button>

      </div>
    </div>
  </div>

  <div id="resultScreen" class="screen">
    <h2>üèÅ Final Score</h2>
    <div id="finalScore"></div>
    <button onclick="location.reload()">Start Over</button>
  </div>

  <div id="badgeNotification" style="display:none; position:fixed; top:50%; left:50%; transform:translate(-50%, -50%); padding:20px 40px; background-color:rgba(0, 119, 204, 0.9); color:white; border-radius:10px; z-index:2000; box-shadow:0 5px 15px rgba(0,0,0,0.3); font-size:1.5em; font-weight:bold;"></div>

  <audio id="clickSound" src="./sounds/click.mp3" preload="auto"></audio>
  <audio id="successSound" src="./sounds/success.wav" preload="auto"></audio>
  <audio id="errorSound" src="./sounds/error.wav" preload="auto"></audio>
  <audio id="badgeSound" src="./sounds/badge.mp3" preload="auto"></audio>

  <script src="deneme4.js"></script>
</body>
</html>
