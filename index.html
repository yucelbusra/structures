<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Structural Engineer Roleplay</title>
  <style>
    /* Basic Layout & Colors */
    body { margin: 0; font-family: sans-serif; background-color: #cce7f6; }
    .screen { display: none; min-height: 100vh; width: 100vw; flex-direction: column; align-items: center; text-align: center; padding: 20px; box-sizing: border-box; }
    .active { display: flex; }
    
    /* Progress Bar */
    #progressBar { display: flex; gap: 20px; margin: 20px 0 40px 0; justify-content: center; }
    .step { padding: 8px 12px; border-radius: 8px; background: #ccc; font-weight: bold; color: #fff; }
    .step.active { background: #0077cc; }
    .step.completed { background: #2ecc71; }

    /* Inputs & Buttons */
    input, select { padding: 8px; margin: 5px 0 15px 0; width: 180px; border: 1px solid #ccc; border-radius: 4px; }
    button { padding: 10px 20px; font-size: 16px; border: none; border-radius: 8px; background-color: #0077cc; color: #fff; cursor: pointer; margin-top: 10px; }
    button:hover { background-color: #005fa3; }
    button:disabled { background-color: #ccc; cursor: not-allowed; opacity: 0.6; }

    /* Canvas & Images */
    canvas { border: 1px solid #888; margin-top: 20px; background: white; }
    img.load-icon { height: 30px; display: none; vertical-align: middle; }

    /* Badges */
    #badgeBar { display: flex; gap: 10px; justify-content: center; margin-bottom: 20px; min-height: 50px; }
    .badge { width: 48px; height: 48px; border-radius: 8px; border: 1px solid #ddd; background: #fff; object-fit: contain; }
    .badge.locked { filter: grayscale(100%) opacity(0.5); }

    /* Calculation Cards */
    .input-card { background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); display: inline-block; vertical-align: top; margin: 10px; width: 200px; text-align: left; }
    .input-card label { font-weight: bold; display: block; margin-bottom: 5px; }
    .input-card small { color: #666; font-size: 0.85em; }

    /* Feedback Box */
    .feedback-box { margin-top: 15px; padding: 15px; border-radius: 5px; display: none; text-align: left; max-width: 500px; margin-left: auto; margin-right: auto; }
    .success-box { background-color: #e0f7e9; border-left: 5px solid #2ecc71; color: #155724; }
    .error-box { background-color: #fff3cd; border-left: 5px solid #ffc107; color: #856404; }

    /* Step Container styling for sequential reveal */
    .calc-step { width: 100%; max-width: 800px; margin-top: 30px; padding-top: 20px; border-top: 2px dashed #aaa; display: none; }

    /* Notification Banner */
    #badgeNotification { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); padding: 20px 40px; background-color: rgba(0, 119, 204, 0.95); color: white; border-radius: 10px; z-index: 2000; font-size: 1.5em; font-weight: bold; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
    @keyframes fadeInOut { 0% { opacity: 0; } 10% { opacity: 1; } 90% { opacity: 1; } 100% { opacity: 0; display: none; } }
  </style>
</head>
<body>

  <div id="progressBar">
    <div class="step" id="step1">üîπ Intro</div>
    <div class="step" id="step2">üìè Slab</div>
    <div class="step" id="step3">üìä Loads</div>
    <div class="step" id="step4">üìê Design</div>
    <div class="step" id="step5">üéì Summary</div>
  </div>

  <div id="badgeBar"></div>

  <div id="introScreen" class="screen active">
    <h1>üßë‚Äçüîß Structural Design Simulator</h1>
    <img src="./img/welcome.gif" alt="Welcome" style="max-width: 300px; margin: 20px 0;">
    <p>Design timber beams for a sustainable building project.<br>Calculate loads, forces, and deflections.</p>
    <button id="continueBtn">Start Project ‚Üí</button>
  </div>

  <div id="canvasScreen" class="screen">
    <h2>1. Define Slab Geometry</h2>
    <div style="display:flex; gap:40px; align-items:flex-start; flex-wrap:wrap; justify-content:center;">
      <div style="text-align:left;">
        <label>Width of Slab (W) (ft):</label><br>
        <input type="number" id="inputWidth" step="0.1" value="20"><br>
        <label>Length of Slab (L) (ft):</label><br>
        <input type="number" id="inputLength" step="0.1" value="30"><br>
        <label>Number of Beams:</label><br>
        <input type="number" id="inputBeamCount" step="1" min="2" value="4"><br>
        <div id="spacingInfo" style="margin:10px 0; font-weight:bold; color:#0077cc;"></div>
        <button id="drawCanvasBtn">Update Visuals</button>
        <br>
        <button id="backBtn" style="background:#666;">‚Üê Back</button>
      </div>
      <div>
        <canvas id="slabCanvas" width="400" height="400"></canvas>
      </div>
    </div>
    <button id="continueToLoadBtn" style="margin-top:30px; width: 200px;">Continue to Loads ‚Üí</button>
  </div>

  <div id="loadScreen" class="screen">
    <h2>2. Apply Loads (psi)</h2>
    <div style="display:flex; gap:40px; align-items:flex-start; justify-content:center; flex-wrap:wrap;">
      <div style="text-align:left;">
        <label>Permanent (Dead) Load:</label><br>
        <input type="number" id="permanentLoad" step="0.1"> 
        <img id="imgPermanent" class="load-icon" src="./img/load-permanent.png"><br>
        <label>Snow Load:</label><br>
        <input type="number" id="snowLoad" step="0.1">
        <img id="imgSnow" class="load-icon" src="./img/load-snow.png"><br>
        <label>Wind Load (+/-):</label><br>
        <input type="number" id="windLoad" step="0.1">
        <img id="imgWindPositive" class="load-icon" src="./img/load-wind.png">
        <img id="imgWindNegative" class="load-icon" src="./img/load-wind-negative.png"><br>
        <label>Mobile (Live) Load:</label><br>
        <input type="number" id="mobileLoad" step="0.1">
        <img id="imgMobile" class="load-icon" src="./img/load-mobile.png"><br>
      </div>
      <div style="max-width:300px;">
        <canvas id="loadCanvas" width="300" height="300"></canvas>
        <div id="combinedLoadImage" style="margin-top:10px;"></div>
        <div id="totalLoadSection" style="margin-top:20px; border-top: 2px dashed #aaa; padding-top:15px; background: rgba(255,255,255,0.8); border-radius:8px; padding:10px;">
          <label style="font-weight:bold; color:#d35400;">Calculate Total Design Load:</label><br>
          <small>(Sum of all loads entered)</small><br>
          <input type="number" id="inputTotalLoad" step="0.1" placeholder="Total psi"><br>
          <button id="checkTotalLoadBtn" style="background:#d35400; width:100%;">Check Total Load</button>
          <div id="loadFeedback" class="feedback-box"></div>
        </div>
      </div>
    </div>
    <div style="margin-top:20px;">
        <button id="backToSlabBtn" style="background:#666;">‚Üê Back</button>
        <button id="continueToTributaryBtn" disabled style="display:none;">Continue to Calculation ‚Üí</button>
    </div>
  </div>

  <div id="tributaryScreen" class="screen">
    <h2>3. Structural Analysis</h2>
    
    <div id="stepA_Tributary" style="width:100%; max-width:800px;">
      <div style="display:flex; justify-content:center; gap:20px; align-items:center;">
          <canvas id="loadCanvasPreview" width="200" height="200"></canvas>
          <div style="text-align:left;">
            <h3>Step A: Tributary Width</h3>
            <label>Select Beam to Analyze:</label><br>
            <select id="beamSelect"></select><br>
            <label>Enter Tributary Width (ft):</label><br>
            <input type="number" id="tributaryWidth" step="0.1"><br>
            <button id="submitTribBtn">Check Width</button>
          </div>
      </div>
      <div id="tribFeedback" class="feedback-box"></div>
    </div>

    <div id="stepB_LineLoad" class="calc-step">
      <h3>Step B: Line Load ($w$)</h3>
      <p>Calculate the uniform line load on the beam.</p>
      
      <div class="input-card" style="width:300px; display:block; margin:0 auto;">
          <label>Line Load ($w$)</label>
          <small>Formula: Total Load (psi) √ó Tributary Width (ft)</small><br>
          <input type="number" id="inputLineLoad" step="0.01" placeholder="lbs/ft">
          <button id="checkLineLoadBtn" style="width:100%;">Check Line Load</button>
      </div>
      <div id="lineLoadFeedback" class="feedback-box"></div>
    </div>

    <div id="stepC_Forces" class="calc-step">
      <h3>Step C: Forces & Deflection</h3>
      <p>Calculate Max Shear, Moment, and Deflection using $w$.</p>
      
      <div style="display:flex; justify-content:center; flex-wrap:wrap;">
        <div class="input-card">
            <label>Max Shear ($V_{max}$)</label>
            <small>Unit: lbs or kN</small><br>
            <input type="number" id="inputVmax" step="0.01" placeholder="wL / 2">
        </div>
        <div class="input-card">
            <label>Max Moment ($M_{max}$)</label>
            <small>Unit: lbs-ft or kN-m</small><br>
            <input type="number" id="inputMmax" step="0.01" placeholder="wL¬≤ / 8">
        </div>
        <div class="input-card">
            <label>Max Deflection ($\delta_{max}$)</label>
            <small>Unit: inches or mm</small><br>
            <input type="number" id="inputDelta" step="0.001" placeholder="Any positive #">
        </div>
      </div>

      <button id="checkForcesBtn" style="font-size:1.1em; padding:15px 40px; background:#27ae60;">Verify Forces</button>
      <div id="forcesFeedback" class="feedback-box"></div>
      
      <button id="continueToSummaryBtn" style="display:none; margin-top:20px;">Finish Project ‚Üí</button>
    </div>
  </div>

  <div id="resultScreen" class="screen">
    <h2>üèÜ Project Summary</h2>
    <div id="finalScore" style="background:white; padding:30px; border-radius:10px; text-align:left; display:inline-block; min-width:300px;"></div>
    <br>
    <button onclick="location.reload()" style="background:#666;">Start New Project</button>
  </div>

  <div id="badgeNotification"></div>
  <audio id="clickSound" src="./sounds/click.mp3"></audio>
  <audio id="successSound" src="./sounds/success.wav"></audio>
  <audio id="errorSound" src="./sounds/error.wav"></audio>
  <audio id="badgeSound" src="./sounds/badge.mp3"></audio>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script src="deneme4.js"></script>
</body>
</html>
